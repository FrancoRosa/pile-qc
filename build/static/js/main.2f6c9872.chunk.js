(this["webpackJsonppile-qc"]=this["webpackJsonppile-qc"]||[]).push([[0],{171:function(e,t,n){},213:function(e,t){},216:function(e,t,n){"use strict";n.r(t);var i=n(1),c=n.n(i),r=n(151),a=n.n(r),s=(n(171),n(172),n(46)),o=n(11),l=n(228),d=n(125),u=n(231),j=n(234),b=n(9),f=n.n(b),g=n(19),O=n(153),x=n.n(O),_=function(){var e=Object(g.a)(f.a.mark((function e(t,n){var i,c,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("... uploading file"),i="http://".concat("161.35.178.247:10000","/api/file"),(c=new FormData).append("file",t),c.append("code",n),e.next=7,x.a.post(i,c,{headers:{"Content-Type":"multipart/form-data"}});case 7:return r=e.sent,console.log(r.data.message),console.log(r.data.points.length),e.abrupt("return",r.data);case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),p=n(17),h=function(){var e=Object(i.useState)(""),t=Object(o.a)(e,2),n=t[0],c=t[1],r=Object(i.useState)("Nothing selected yet"),a=Object(o.a)(r,2),l=a[0],d=a[1],u=Object(i.useState)(null),j=Object(o.a)(u,2),b=j[0],f=j[1],g=Object(i.useState)(!1),O=Object(o.a)(g,2),x=O[0],h=O[1],m=Object(s.d)((function(e){return e.setPoints})),v=Object(s.e)((function(e){return e.points})),N=Object(s.d)((function(e){return e.setFile}));Object(i.useEffect)((function(){document.querySelector(".file-input").addEventListener("change",(function(e){var t=e.target.files[0],n=e.target.files[0].name;c(t),d(n)}),!1)}),[]);return Object(p.jsxs)("div",{className:"columns",children:[Object(p.jsx)("div",{className:"column file has-name",children:Object(p.jsx)("label",{className:"file-label",children:Object(p.jsx)("input",{className:"file-input",type:"file",accept:".csv, .xlsx"})})}),Object(p.jsx)("div",{className:"column",children:n?Object(p.jsx)("div",{className:"is-flex is-justify-content-center",children:Object(p.jsx)("button",{className:"button is-outlined is-success",onClick:function(){return e=n,f(null),h(!0),void _(e).then((function(e){f(e.message),m(e.points),h(!1),N(l)})).catch((function(){f(!1),m([]),h(!1)}));var e},children:"Upload"})}):""}),Object(p.jsxs)("div",{className:"column",children:[x&&Object(p.jsxs)("p",{className:"animate__animated animate__zoomIn animate__infinite",children:["... Processing"," "]}),b?Object(p.jsxs)("div",{className:"is-flex is-align-content-center is-flex-direction-column",children:[Object(p.jsx)("p",{className:b?"has-text-success":"has-text-fail",children:b?"Success":"Fail"}),Object(p.jsxs)("p",{children:["Piles found: ",v.length]})]}):""]}),Object(p.jsx)("br",{})]})},m=n(100);n.n(m).a.workerClass=n(212).default;var v=[135,206,235,128],N=[144,238,144,128],C=[255,165,0,128],S=[255,105,180,128],y=[255,0,0,128],k=function(){var e=Object(i.useState)(!1),t=Object(o.a)(e,2),n=t[0],c=t[1],r=Object(i.useState)(!1),a=Object(o.a)(r,2),b=a[0],f=a[1],g=Object(i.useState)([]),O=Object(o.a)(g,2),x=O[0],_=O[1],m=Object(s.e)((function(e){return e.points})),k=Object(s.e)((function(e){return e.file})),w={longitude:m.length>3?m[3].lng_field:-93,latitude:m.length>3?m[3].lat_field:40,zoom:21,maxZoom:25,pitch:60,bearing:0};return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)(l.a,{initialViewState:w,controller:!0,getTooltip:function(e){var t=e.object;return t&&"Order: [".concat(t.order,"]\n          Code: ").concat(t.pile_id,"\n          angle: ").concat(t.angle_g_error,"\n          Xdiff: ").concat(t.x_g_error,"\n          Ydiff: ").concat(t.y_g_error)},children:[Object(p.jsx)(d.b,{mapboxApiAccessToken:"pk.eyJ1Ijoia20xMTVmcmFuY28iLCJhIjoiY2t0eXQ3cHBhMGI3aTMxcG14dnN0OHJveSJ9.LWxkBiVPF9UfGWMI4sWakQ",children:Object(p.jsx)(d.a,{})}),Object(p.jsx)(u.a,{data:m,diskResolution:6,radius:.2,extruded:!0,pickable:!0,elevationScale:1,getPosition:function(e){return[e.lng_field,e.lat_field]},getFillColor:function(e){return function(e){if("angle_g_error"in e){var t=e.angle_g_error,n=e.x_g_error,i=e.y_g_error;return t>.69?S:n>.25?C:i[0]>.5||i[1]>.5?y:N}return v}(e)},getLineColor:[0,0,0],getElevation:function(e){return 2+e.z_field-e.z_design},onClick:function(e){var t=e.object.order,n=m.filter((function(e){return e.order[0]===t[0]&&e.order[1]===t[1]-1}))[0],i=m.filter((function(e){return e.order[0]===t[0]&&e.order[1]===t[1]+1}))[0];_([n,e.object,i]),c(!0)}}),Object(p.jsx)(u.a,{data:m,diskResolution:6,radius:.2,extruded:!0,elevationScale:1,getPosition:function(e){return[e.lng_design,e.lat_design]},getFillColor:[0,30,0,30],getLineColor:[10,10,10,30],getElevation:2,wireframe:!0}),n&&Object(p.jsx)(j.a,{lineWidthMaxPixels:3,lineWidthMinPixels:2,getRadius:3,data:x,getPosition:function(e){return[e.lng_design,e.lat_design]},getColor:[10,10,10,30],getFillColor:[10,10,10,30],getLineColor:[10,10,10,30],filled:!0,stroked:!0,opacity:.8})]}),n&&Object(p.jsxs)("div",{className:"details card animate__animated animate__fadeInRight",children:[Object(p.jsx)("h1",{children:"Target pile:"}),Object(p.jsxs)("p",{children:["Pile id: ",x[1].pile_id]}),Object(p.jsxs)("p",{children:["N design: ",x[1].y_design]}),Object(p.jsxs)("p",{children:["E design: ",x[1].x_design]}),Object(p.jsxs)("p",{children:["Lat design: ",x[1].lat_design]}),Object(p.jsxs)("p",{children:["Lng design: ",x[1].lng_design]}),Object(p.jsx)("hr",{}),Object(p.jsxs)("p",{className:x[1].angle_g_error<.69?"green":"red",children:["Angle error: ",x[1].angle_g_error]}),Object(p.jsxs)("p",{className:x[1].x_g_error<.25?"green":"red",children:["Easting error: ",x[1].x_g_error]}),Object(p.jsxs)("p",{className:x[1].y_g_error[0]<.25||x[1].y_g_error[1]<.25?"green":"red",children:["Northing error: ",x[1].y_g_error[0],","," ",x[1].y_g_error[0]]}),Object(p.jsx)("button",{className:"button",onClick:function(){document.querySelector(".details").classList.add("animate__fadeOutRight"),setTimeout((function(){c(!1),_([])}),1e3)},children:"Close"})]}),b&&Object(p.jsxs)("div",{className:"upload animate__animated animate__fadeInLeft",children:[Object(p.jsx)("h1",{children:"Upload file"}),Object(p.jsx)(h,{}),Object(p.jsx)("hr",{}),k&&Object(p.jsxs)("p",{children:["Current file: ",k]}),Object(p.jsx)("hr",{}),Object(p.jsx)("button",{className:"button",onClick:function(){f(!1)},children:"Close"})]}),!b&&Object(p.jsx)("div",{className:"upload animate__animated animate__fadeInLeft",children:Object(p.jsx)("button",{onClick:function(){return f(!0)},children:"Upload"})})]})},w=n(16),I=function(e){return JSON.parse(window.localStorage.getItem(e))||P[e]},L=function(e,t){window.localStorage.setItem(e,JSON.stringify(t))},P={points:[],file:""},F={points:I("points"),setPoints:Object(s.b)((function(e,t){e.points=Object(w.a)(t),L("points",t)})),file:I("file"),setFile:Object(s.b)((function(e,t){e.file=Object(w.a)(t),L("file",t)}))},J=Object(s.c)(F);a.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(s.a,{store:J,children:Object(p.jsx)(k,{})})}),document.getElementById("root"))},93:function(e,t){}},[[216,1,2]]]);
//# sourceMappingURL=main.2f6c9872.chunk.js.map