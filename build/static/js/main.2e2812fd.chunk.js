(this["webpackJsonppile-qc"]=this["webpackJsonppile-qc"]||[]).push([[0],{171:function(e,t,n){},213:function(e,t){},216:function(e,t,n){"use strict";n.r(t);var i=n(1),c=n.n(i),a=n(151),r=n.n(a),s=(n(171),n(172),n(46)),l=n(2),o=n(11),d=n(228),j=n(125),u=n(231),b=n(234),f=n(9),g=n.n(f),O=n(19),x=n(153),h=n.n(x),_=function(){var e=Object(O.a)(g.a.mark((function e(t,n){var i,c,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("... uploading file"),i="http://".concat("161.35.178.247:10000","/api/file"),(c=new FormData).append("file",t),c.append("code",n),e.next=7,h.a.post(i,c,{headers:{"Content-Type":"multipart/form-data"}});case 7:return a=e.sent,console.log(a.data.message),console.log(a.data.points.length),e.abrupt("return",a.data);case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),p=n(14),m=function(){var e=Object(i.useState)(""),t=Object(o.a)(e,2),n=t[0],c=t[1],a=Object(i.useState)("Nothing selected yet"),r=Object(o.a)(a,2),l=r[0],d=r[1],j=Object(i.useState)(null),u=Object(o.a)(j,2),b=u[0],f=u[1],g=Object(i.useState)(!1),O=Object(o.a)(g,2),x=O[0],h=O[1],m=Object(s.d)((function(e){return e.setPoints})),v=Object(s.e)((function(e){return e.points})),C=Object(s.d)((function(e){return e.setFile}));Object(i.useEffect)((function(){document.querySelector(".file-input").addEventListener("change",(function(e){var t=e.target.files[0],n=e.target.files[0].name;c(t),d(n)}),!1)}),[]);return Object(p.jsxs)("div",{className:"columns",children:[Object(p.jsx)("div",{className:"column file has-name",children:Object(p.jsx)("label",{className:"file-label",children:Object(p.jsx)("input",{className:"file-input",type:"file",accept:".csv, .xlsx"})})}),Object(p.jsx)("div",{className:"column",children:n?Object(p.jsx)("div",{className:"is-flex is-justify-content-center",children:Object(p.jsx)("button",{className:"button is-outlined is-success",onClick:function(){return e=n,f(null),h(!0),void _(e).then((function(e){f(e.message),m(e.points),h(!1),C(l)})).catch((function(){f(!1),m([]),h(!1)}));var e},children:"Upload"})}):""}),Object(p.jsxs)("div",{className:"column",children:[x&&Object(p.jsxs)("p",{className:"animate__animated animate__zoomIn animate__infinite",children:["... Processing"," "]}),b?Object(p.jsxs)("div",{className:"is-flex is-align-content-center is-flex-direction-column",children:[Object(p.jsx)("p",{className:b?"has-text-success":"has-text-fail",children:b?"Success":"Fail"}),Object(p.jsxs)("p",{children:["Piles found: ",v.length]})]}):""]}),Object(p.jsx)("br",{})]})},v=n(100);n.n(v).a.workerClass=n(212).default;var C=[135,206,235,128],N=[144,238,144,128],S=[255,165,0,128],k=[255,105,180,128],y=[255,0,0,128],L=function(){var e=Object(i.useState)(!1),t=Object(o.a)(e,2),n=t[0],c=t[1],a=Object(i.useState)(!1),r=Object(o.a)(a,2),f=r[0],g=r[1],O=Object(i.useState)(!1),x=Object(o.a)(O,2),h=x[0],_=x[1],v=Object(i.useState)([]),L=Object(o.a)(v,2),w=L[0],P=L[1],I=Object(i.useState)({}),F=Object(o.a)(I,2),M=F[0],J=F[1],E=Object(i.useState)([]),R=Object(o.a)(E,2),T=R[0],W=R[1],q=Object(i.useRef)(null),z=Object(s.e)((function(e){return e.points})),U=Object(s.e)((function(e){return e.file})),A={longitude:z.length>3?z[3].lng_field:-93,latitude:z.length>3?z[3].lat_field:40,zoom:21,maxZoom:25,pitch:60,bearing:0},B=Object(i.useState)(A),G=Object(o.a)(B,2),V=G[0],Y=G[1];return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)(d.a,{initialViewState:V,controller:!0,getTooltip:function(e){var t=e.object;return t&&"Order: [".concat(t.order,"]\n          Code: ").concat(t.pile_id,"\n          angle: ").concat(t.angle_g_error,"\n          Xdiff: ").concat(t.x_g_error,"\n          Ydiff: ").concat(t.y_g_error)},children:[Object(p.jsx)(j.b,{mapboxApiAccessToken:"pk.eyJ1Ijoia20xMTVmcmFuY28iLCJhIjoiY2t0eXQ3cHBhMGI3aTMxcG14dnN0OHJveSJ9.LWxkBiVPF9UfGWMI4sWakQ",children:Object(p.jsx)(j.a,{})}),Object(p.jsx)(u.a,{data:z,diskResolution:6,radius:.2,extruded:!0,pickable:!0,elevationScale:1,getPosition:function(e){return[e.lng_field,e.lat_field]},getFillColor:function(e){return function(e){if("angle_g_error"in e){var t=e.angle_g_error,n=e.x_g_error,i=e.y_g_error;return t>.69?k:n>.25?S:i[0]>.5||i[1]>.5?y:N}return C}(e)},getLineColor:[0,0,0],getElevation:function(e){return 2+e.z_field-e.z_design},onClick:function(e){var t=e.object.order,n=z.filter((function(e){return e.order[0]===t[0]&&e.order[1]===t[1]-1}))[0],i=z.filter((function(e){return e.order[0]===t[0]&&e.order[1]===t[1]+1}))[0];W([n,e.object,i]),c(!0)}}),Object(p.jsx)(u.a,{data:z,diskResolution:6,radius:.2,extruded:!0,elevationScale:1,getPosition:function(e){return[e.lng_design,e.lat_design]},getFillColor:[0,30,0,30],getLineColor:[10,10,10,30],getElevation:2,wireframe:!0}),n&&Object(p.jsx)(b.a,{lineWidthMaxPixels:3,lineWidthMinPixels:2,getRadius:3,data:T,getPosition:function(e){return[e.lng_design,e.lat_design]},getColor:[10,10,10,30],getFillColor:[10,10,10,30],getLineColor:[10,10,10,30],filled:!0,stroked:!0,opacity:.8}),h&&Object(p.jsx)(b.a,{lineWidthMaxPixels:3,lineWidthMinPixels:2,getRadius:3,data:[M],getPosition:function(e){return[e.lng_design,e.lat_design]},getColor:[100,10,10,30],getFillColor:[100,10,10,30],getLineColor:[100,10,10,30],filled:!0,stroked:!0,opacity:.5})]}),n&&Object(p.jsxs)("div",{className:"details card animate__animated animate__fadeInRight",children:[Object(p.jsx)("h1",{children:"Target pile:"}),Object(p.jsxs)("p",{children:["Pile id: ",T[1].pile_id]}),Object(p.jsxs)("p",{children:["N design: ",T[1].y_design]}),Object(p.jsxs)("p",{children:["E design: ",T[1].x_design]}),Object(p.jsxs)("p",{children:["Lat design: ",T[1].lat_design]}),Object(p.jsxs)("p",{children:["Lng design: ",T[1].lng_design]}),Object(p.jsx)("hr",{}),Object(p.jsxs)("p",{className:T[1].angle_g_error<.69?"green":"red",children:["Angle error: ",T[1].angle_g_error]}),Object(p.jsxs)("p",{className:T[1].x_g_error<.25?"green":"red",children:["Easting error: ",T[1].x_g_error]}),Object(p.jsxs)("p",{className:T[1].y_g_error[0]<.25||T[1].y_g_error[1]<.25?"green":"red",children:["Northing error: ",T[1].y_g_error[0],","," ",T[1].y_g_error[0]]}),Object(p.jsx)("button",{className:"button",onClick:function(){document.querySelector(".details").classList.add("animate__fadeOutRight"),setTimeout((function(){c(!1),W([])}),1e3)},children:"Close"})]}),f&&Object(p.jsxs)("div",{className:"upload animate__animated animate__fadeInLeft",children:[Object(p.jsx)("h1",{children:"Upload file"}),Object(p.jsx)(m,{}),Object(p.jsx)("hr",{}),U&&Object(p.jsxs)("p",{children:["Current file: ",U]}),Object(p.jsx)("hr",{}),Object(p.jsx)("button",{className:"button",onClick:function(){g(!1)},children:"Close"})]}),!f&&Object(p.jsx)("div",{className:"upload animate__animated animate__fadeInLeft",children:Object(p.jsx)("button",{onClick:function(){g(!0),_(!1)},children:"Upload"})}),h&&Object(p.jsxs)("div",{className:"search animate__animated animate__fadeInLeft",children:[Object(p.jsx)("h1",{children:"Search pile"}),Object(p.jsx)("input",{type:"text",ref:q}),Object(p.jsx)("button",{onClick:function(){var e=q.current.value.toLowerCase();console.log(e);var t=z.filter((function(t){return t.pile_id.toLowerCase().includes(e)}));t.splice(10),P(t)},children:"Search"}),Object(p.jsx)("hr",{}),w.map((function(e){return Object(p.jsx)("p",{className:"pile-list",onClick:function(){return function(e){Y(Object(l.a)(Object(l.a)({},V),{},{latitude:e.lat_design,longitude:e.lng_design})),J(e)}(e)},children:e.pile_id})})),Object(p.jsx)("hr",{}),Object(p.jsx)("button",{className:"button",onClick:function(){_(!1)},children:"Close"})]}),!h&&!f&&Object(p.jsx)("div",{className:"search animate__animated animate__fadeInLeft",children:Object(p.jsx)("button",{onClick:function(){_(!0),g(!1)},children:"Search"})})]})},w=n(17),P=function(e){return JSON.parse(window.localStorage.getItem(e))||F[e]},I=function(e,t){window.localStorage.setItem(e,JSON.stringify(t))},F={points:[],file:""},M={points:P("points"),setPoints:Object(s.b)((function(e,t){e.points=Object(w.a)(t),I("points",t)})),file:P("file"),setFile:Object(s.b)((function(e,t){e.file=Object(w.a)(t),I("file",t)}))},J=Object(s.c)(M);r.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(s.a,{store:J,children:Object(p.jsx)(L,{})})}),document.getElementById("root"))},93:function(e,t){}},[[216,1,2]]]);
//# sourceMappingURL=main.2e2812fd.chunk.js.map