(this["webpackJsonppile-qc"]=this["webpackJsonppile-qc"]||[]).push([[0],{171:function(e,t,n){},212:function(e,t){},215:function(e,t,n){"use strict";n.r(t);var i=n(1),c=n.n(i),r=n(151),s=n.n(r),a=(n(171),n(172),n(46)),o=n(11),l=n(227),d=n(124),u=n(230),j=n(233),b=n(9),f=n.n(b),g=n(19),O=n(153),x=n.n(O),p=function(){var e=Object(g.a)(f.a.mark((function e(t,n){var i,c,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("... uploading file"),i="http://".concat("http://161.35.178.247:10000","/api/file"),(c=new FormData).append("file",t),c.append("code",n),e.next=7,x.a.post(i,c,{headers:{"Content-Type":"multipart/form-data"}});case 7:return r=e.sent,console.log(r.data.message),console.log(r.data.points.length),e.abrupt("return",r.data);case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),_=n(17),h=function(){var e=Object(i.useState)(""),t=Object(o.a)(e,2),n=t[0],c=t[1],r=Object(i.useState)("Nothing selected yet"),s=Object(o.a)(r,2),l=s[0],d=s[1],u=Object(i.useState)(null),j=Object(o.a)(u,2),b=j[0],f=j[1],g=Object(i.useState)(!1),O=Object(o.a)(g,2),x=O[0],h=O[1],m=Object(a.d)((function(e){return e.setPoints})),v=Object(a.e)((function(e){return e.points})),N=Object(a.d)((function(e){return e.setFile}));Object(i.useEffect)((function(){document.querySelector(".file-input").addEventListener("change",(function(e){var t=e.target.files[0],n=e.target.files[0].name;c(t),d(n)}),!1)}),[]);return Object(_.jsxs)("div",{className:"columns",children:[Object(_.jsx)("div",{className:"column file has-name",children:Object(_.jsx)("label",{className:"file-label",children:Object(_.jsx)("input",{className:"file-input",type:"file",accept:".csv, .xlsx"})})}),Object(_.jsx)("div",{className:"column",children:n?Object(_.jsx)("div",{className:"is-flex is-justify-content-center",children:Object(_.jsx)("button",{className:"button is-outlined is-success",onClick:function(){return e=n,f(null),h(!0),void p(e).then((function(e){f(e.message),m(e.points),h(!1),N(l)})).catch((function(){f(!1),m([]),h(!1)}));var e},children:"Upload"})}):""}),Object(_.jsxs)("div",{className:"column",children:[x&&Object(_.jsxs)("p",{className:"animate__animated animate__zoomIn animate__infinite",children:["... Processing"," "]}),b?Object(_.jsxs)("div",{className:"is-flex is-align-content-center is-flex-direction-column",children:[Object(_.jsx)("p",{className:b?"has-text-success":"has-text-fail",children:b?"Success":"Fail"}),Object(_.jsxs)("p",{children:["Piles found: ",v.length]})]}):""]}),Object(_.jsx)("br",{})]})},m=[135,206,235,128],v=[144,238,144,128],N=[255,165,0,128],S=[255,105,180,128],y=[255,0,0,128],C=function(){var e=Object(i.useState)(!1),t=Object(o.a)(e,2),n=t[0],c=t[1],r=Object(i.useState)(!1),s=Object(o.a)(r,2),b=s[0],f=s[1],g=Object(i.useState)([]),O=Object(o.a)(g,2),x=O[0],p=O[1],C=Object(a.e)((function(e){return e.points})),k=Object(a.e)((function(e){return e.file})),w={longitude:C.length>3?C[3].lng_field:-93,latitude:C.length>3?C[3].lat_field:40,zoom:21,maxZoom:25,pitch:60,bearing:0};return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsxs)(l.a,{initialViewState:w,controller:!0,getTooltip:function(e){var t=e.object;return t&&"Order: [".concat(t.order,"]\n          Code: ").concat(t.pile_id,"\n          angle: ").concat(t.angle_g_error,"\n          Xdiff: ").concat(t.x_g_error,"\n          Ydiff: ").concat(t.y_g_error)},children:[Object(_.jsx)(d.b,{mapboxApiAccessToken:"pk.eyJ1Ijoia20xMTVmcmFuY28iLCJhIjoiY2t0eXQ3cHBhMGI3aTMxcG14dnN0OHJveSJ9.LWxkBiVPF9UfGWMI4sWakQ",children:Object(_.jsx)(d.a,{})}),Object(_.jsx)(u.a,{data:C,diskResolution:6,radius:.2,extruded:!0,pickable:!0,elevationScale:1,getPosition:function(e){return[e.lng_field,e.lat_field]},getFillColor:function(e){return function(e){if("angle_g_error"in e){var t=e.angle_g_error,n=e.x_g_error,i=e.y_g_error;return t>.69?S:n>.25?N:i[0]>.5||i[1]>.5?y:v}return m}(e)},getLineColor:[0,0,0],getElevation:function(e){return 2+e.z_field-e.z_design},onClick:function(e){var t=e.object.order,n=C.filter((function(e){return e.order[0]===t[0]&&e.order[1]===t[1]-1}))[0],i=C.filter((function(e){return e.order[0]===t[0]&&e.order[1]===t[1]+1}))[0];p([n,e.object,i]),c(!0)}}),Object(_.jsx)(u.a,{data:C,diskResolution:6,radius:.2,extruded:!0,elevationScale:1,getPosition:function(e){return[e.lng_design,e.lat_design]},getFillColor:[0,30,0,30],getLineColor:[10,10,10,30],getElevation:2,wireframe:!0}),n&&Object(_.jsx)(j.a,{lineWidthMaxPixels:3,lineWidthMinPixels:2,getRadius:3,data:x,getPosition:function(e){return[e.lng_design,e.lat_design]},getColor:[10,10,10,30],getFillColor:[10,10,10,30],getLineColor:[10,10,10,30],filled:!0,stroked:!0,opacity:.8})]}),n&&Object(_.jsxs)("div",{className:"details card animate__animated animate__fadeInRight",children:[Object(_.jsx)("h1",{children:"Target pile:"}),Object(_.jsxs)("p",{children:["Pile id: ",x[1].pile_id]}),Object(_.jsxs)("p",{children:["N design: ",x[1].y_design]}),Object(_.jsxs)("p",{children:["E design: ",x[1].x_design]}),Object(_.jsxs)("p",{children:["Lat design: ",x[1].lat_design]}),Object(_.jsxs)("p",{children:["Lng design: ",x[1].lng_design]}),Object(_.jsx)("hr",{}),Object(_.jsxs)("p",{className:x[1].angle_g_error<.69?"green":"red",children:["Angle error: ",x[1].angle_g_error]}),Object(_.jsxs)("p",{className:x[1].x_g_error<.25?"green":"red",children:["Easting error: ",x[1].x_g_error]}),Object(_.jsxs)("p",{className:x[1].y_g_error[0]<.25||x[1].y_g_error[1]<.25?"green":"red",children:["Northing error: ",x[1].y_g_error[0],","," ",x[1].y_g_error[0]]}),Object(_.jsx)("button",{className:"button",onClick:function(){document.querySelector(".details").classList.add("animate__fadeOutRight"),setTimeout((function(){c(!1),p([])}),1e3)},children:"Close"})]}),b&&Object(_.jsxs)("div",{className:"upload animate__animated animate__fadeInLeft",children:[Object(_.jsx)("h1",{children:"Upload file"}),Object(_.jsx)(h,{}),Object(_.jsx)("hr",{}),k&&Object(_.jsxs)("p",{children:["Current file: ",k]}),Object(_.jsx)("hr",{}),Object(_.jsx)("button",{className:"button",onClick:function(){f(!1)},children:"Close"})]}),!b&&Object(_.jsx)("div",{className:"upload animate__animated animate__fadeInLeft",children:Object(_.jsx)("button",{onClick:function(){return f(!0)},children:"Upload"})})]})},k=n(16),w=function(e){return JSON.parse(window.localStorage.getItem(e))||L[e]},I=function(e,t){window.localStorage.setItem(e,JSON.stringify(t))},L={points:[],file:""},P={points:w("points"),setPoints:Object(a.b)((function(e,t){e.points=Object(k.a)(t),I("points",t)})),file:w("file"),setFile:Object(a.b)((function(e,t){e.file=Object(k.a)(t),I("file",t)}))},F=Object(a.c)(P);s.a.render(Object(_.jsx)(c.a.StrictMode,{children:Object(_.jsx)(a.a,{store:F,children:Object(_.jsx)(C,{})})}),document.getElementById("root"))},93:function(e,t){}},[[215,1,2]]]);
//# sourceMappingURL=main.228188dc.chunk.js.map